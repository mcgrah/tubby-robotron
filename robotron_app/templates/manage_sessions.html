{% extends "base_scripted.html"%}
{% block pageScript %}
{% load filters %}
<script>
        $( function() {
            $("input[id*='-day']").each(function(){
                $(this).datepicker({
                "dateFormat": "yy-mm-dd",
                "firstDay": 1
            });
            });

            $("input[id*='-hour']").each(function(){
                $(this).timepicker({
                    'timeFormat':'H:i',
                    'scrollDefault':'now'
                });
            });
        } );
    </script>
{% endblock %}
{% block title %}Manage Character Sessions{% endblock %}

{% block minicrumbs %}
<li class="breadcrumb-item"><a href="{{ character.batch.project.get_absolute_url }}">{{ character.batch.project.name }}</a></li>
<li class="breadcrumb-item"><a href="{{ character.batch.get_absolute_url }}">{{ character.batch.name }}</a></li>
<li class="breadcrumb-item"><a href="{{ character.get_absolute_url }}">{{ character.name }}</a></li>
<li class="breadcrumb-item active" aria-current="page">Sessions</li>
{% endblock %}

{% block content %}
{#    {{ formset.media }}#}
    <h2>Character: <strong>{{ character.name }}</strong></h2>	
    <p>
    <div class="row">
        <div class="col-6">
            <div class="row align-items-center">
                <div class="col-md-auto">
                    <h4>Details</h4>
                </div>
            </div>
        <table class="table table-sm">
        <tbody>
            <tr><th scope="row">Batch: </th><td>{{ character.batch.name }}</td></tr>
            <!-- <tr><th scope="row">Character: </th><td>{{ character.name }}</td></tr> -->
            <tr><th scope="row">Actor: </th><td>{{ character.actor.name }}</td></tr>
            <tr><th scope="row">Files: </th><td>{{ character.files_count }}</td></tr>
            <tr><th scope="row">Delivery Date: </th><td>{{ character.delivery_date|date:"Y-m-d" }}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{{ character.delivery_time|time:"H:i" }}</td></tr>
        </tbody>
        </table>
        </div>
    </div>
	<hr>

    <div class="row align-items-center">
        <div class="col-md-auto">
            <h4>Sessions</h4>
        </div>
    </div>

		<form method="post">
		<hr>

        {% csrf_token %}
        {% load i18n widget_tweaks %}
        {{ formset.management_form }}
        <!-- AS GRID!-->
{#        <div class="container">#}
            <div class="row justify-content-start align-items-center">
                <div class="col-1 h6"><strong>#</strong></div>
                <div class="col-2 h6"><strong>Day</strong></div>
                <div class="col-1 h6"><strong>Hour</strong></div>
                <div class="col-2 h6"><strong>Duration</strong></div>
                <div class="col-3 h6"><strong>Director</strong></div>
                <div class="col-3 h6"><strong>Translator</strong></div>
            </div>
		<hr>
        {% for form in formset %}
            <div class="row justify-content-start align-items-center">
                <div class="col d-none">{{ form.id }}</div>
                <div class="col-1">{{ forloop.counter }}</div>
                <div class="col-2">{{ form.day|attr:"class:form-control" }}</div>
                <div class="col-1">{{ form.hour|attr:"class:form-control" }}</div>
                <div class="col-2">{{ form.duration_blocks|attr:"class:form-control" }}</div>
                <div class="col-3">{{ form.director|attr:"class:form-control"}}</div>
{% if request.user|isRoboto %}
                <div class="col-3">{{ form.translator|attr:"class:form-control"}}</div>
{% else %}
                <div class="col-3">{{ form.translator|attr:"class:form-control"|attr:"disabled"}}</div>
{% endif %}
            </div>
            {% if form.non_field_errors %}
                <div class="row justify-content-start align-items-center alert alert-danger">
                    {% for error in form.non_field_errors %}
                        {{ error }}
                    {% endfor %}
                </div>
            {% endif %}
            {% for field in form %}
                {% if field.errors %}
                    {% for error in field.errors %}
                        <div class="row justify-content-start align-items-center alert alert-danger">
                            {{ field.name }}: {{ error }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endfor %}
        {% endfor %}
		
        <div class="form-group row justify-content-end mt-3">
            <div class="col">
            <button type="submit" class="btn btn-primary float-right">{% trans "Update" %}</button>
            <a class="btn btn-secondary mr-1 float-right" href="." role="button">Undo Changes</a>
            </div>
        </div>
{#        </div>#}
        <!-- AS TABLE
        <table class="table table-borderless">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Day</th>
                    <th>Hour</th>
                    <th>Duration</th>
                    <th>Director</th>
                    <th>Translator</th>
                </tr>
            </thead>
{#        {% for form in formset %}#}
            <tr>
{#            <td>{{ forloop.counter }}</td>#}
{#            <td>{{ form.day|attr:"class:form-control form-control-sm" }}</td>#}
{#            <td>{{ form.hour|attr:"class:form-control form-control-sm" }}</td>#}
{#            <td>{{ form.duration|attr:"class:form-control form-control-sm" }}</td>#}
{#            <td>{{ form.director|attr:"class:form-control form-control-sm" }}</td>#}
{#            <td>{{ form.translator|attr:"class:form-control form-control-sm"|attr:"style:" }}</td>#}
            </tr>
{#        {% endfor %}#}
        </table>
        !-->
<script>
$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip(); 
});
</script>
</form>
{% endblock %}